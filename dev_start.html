<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Peter 'fracpete' Reutemann">
    <link rel="shortcut icon" href="favicon.ico">

    <title>ADAMS - The Advanced Data mining And Machine learning System</title>

    <!-- load jquery at start for imports -->
    <script src="js/jquery.min.js"></script>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/adams.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <span id="gaimport"></span>
    <script>$("#gaimport").load("ga.html");</script>

    <span id="navbarimport"></span>
    <script>$("#navbarimport").load("navbar.html");</script>

    <div class="container">
      <div class="page-header">
        <h1>Get started (Developer)</h1>
      </div>
      
      <div class="panel-group" id="accordion-dev">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion-dev" href="#collapse-dev-1">
                Requirements
              </a>
            </h4>
          </div>
          <div id="collapse-dev-1" class="panel-collapse collapse">
            <div class="panel-body">
              <p>The requirements for ADAMS are as follows:</p>
              <ul>
                <li><a href="http://www.oracle.com/technetwork/java/" target="_blank">Java</a> 1.8+</li>
                <li><a href="http://maven.apache.org/" target="_blank">Maven</a> 3.0+</li>
                <li><a href="http://www.tug.org/texlive/" target="_blank">TexLive</a> 2010+ for compiling the LaTeX manuals (use <a href="https://tug.org/mactex/" target="_blank">MacTex</a> for Mac OSX)</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion-dev" href="#collapse-dev-2">
                Source code
              </a>
            </h4>
          </div>
          <div id="collapse-dev-2" class="panel-collapse collapse">
            <div class="panel-body">
              <div class="panel-group" id="accordion-source">
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-source" href="#collapse-source-1">
                        Obtaining the source code
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-source-1" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>The ADAMS source code is hosted in the following subversion repository:</p>
                      <p><code><a href="https://svn.cms.waikato.ac.nz/svn/adams/base/trunk/" target="_blank">https://svn.cms.waikato.ac.nz/svn/adams/base/trunk/</a></code></p>
                      <p>You can check out the code ("trunk") in the console with the following command:</p>
                      <p><code>svn checkout <a href="https://svn.cms.waikato.ac.nz/svn/adams/base/trunk" target="_blank">https://svn.cms.waikato.ac.nz/svn/adams/base/trunk</a> adams</code></p>
                      <p>Further modules are available:</p>
                      <ul>
                        <li>
                          <p><strong>addons</strong> (less common used):</p>
                          <p><code><a href="https://svn.cms.waikato.ac.nz/svn/adams/addons/trunk/" target="_blank">https://svn.cms.waikato.ac.nz/svn/adams/addons/trunk/</a></code></p>
                        </li>
                        <li>
                          <p><strong>incubator</strong> (experimental):</p>
                          <p><code><a href="https://svn.cms.waikato.ac.nz/svn/adams/incubator/trunk/" target="_blank">https://svn.cms.waikato.ac.nz/svn/adams/incubator/trunk/</a></code></p>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-source" href="#collapse-source-2">
                        Compiling the source code
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-source-2" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>ADAMS uses <a href="http://maven.apache.org/" target="_blank">Maven</a> as build tool. See the Requirements section for more details on what you need for compiling the code.</p>
                      <p>Download the <a href="resources/settings.xml" target="_blank">settings.xml</a> file and place it in the following directory (if you are behind a proxy, see section <strong>Proxy</strong> below):
                      <ul>
                        <li>Linux/Unix/Mac: <code>$HOME/.m2</code></li>
                        <li>Windows: <code>%USERPROFILE%\.m2</code></li>
                      </ul>
                      </p>
                      <p>Starting with Java 8, you need to set the environment variable <code>JAVA_TOOL_OPTIONS</code> to <code>-Djsse.enableSNIExtension=false</code> to avoid the <code>Server SSL Error - handshake alert: unrecognized_name</code> error message.</p>
                      <p>You can compile the source code in the console as follows:</p>
                      <p><code>mvn clean install</code></p>
                      <p>If you want to skip the tests, use the following:</p>
                      <p><code>mvn clean install -DskipTests=true</code></p>
                      <p>This will generate a ZIP archive in the <em>target</em> directory of the <em>adams-base-all</em> module that contains all the jars and scripts to start ADAMS and the generated documentation.</p>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-source" href="#collapse-source-3">
                        Proxy
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-source-3" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>If you are behind a proxy, you need to tell Maven about it. Let's assume that your proxy is called proxy.blah.com and its port 3128.</p>
                      <p>If you don't need a password to connect to it, you can add the following tag to your <em>settings.xml</em> file</p>
                      <pre>
&lt;proxy&gt;
  &lt;active&gt;true&lt;/active&gt;
  &lt;protocol&gt;http&lt;/protocol&gt;
  &lt;host&gt;proxy.blah.com&lt;/host&gt;
  &lt;port&gt;3128&lt;/port&gt;
  &lt;nonProxyHosts&gt;localhost|*.blah.com&lt;/nonProxyHosts&gt;
&lt;/proxy&gt;</pre>
                      <p>If your proxy requires a user/password, then you have to 1) generate a master password with Maven (which gets stored in <em>.m2/settings-security.xml</em>) and then 2) the actual password for the proxy. The details are explained <a href="http://maven.apache.org/guides/mini/guide-encryption.html" target="_blank">here</a> on the Maven homepage. Once you've created the passwords, you have to add the following tag to your <em>settings.xml</em> file and replace the <em>USER</em> and <em>ENCRYPTED_PASSWORD</em> placeholders accordingly.</p>
                      <pre>
&lt;proxy&gt;
  &lt;active&gt;true&lt;/active&gt;
  &lt;protocol&gt;http&lt;/protocol&gt;
  &lt;host&gt;proxy.blah.com&lt;/host&gt;
  &lt;port&gt;3128&lt;/port&gt;
  &lt;username&gt;USER&lt;/username&gt;
  &lt;password&gt;{ENCRYPTED_PASSWORD}&lt;/password&gt;
  &lt;nonProxyHosts&gt;localhost|*.blah.com&lt;/nonProxyHosts&gt;
&lt;/proxy&gt;</pre>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion-dev" href="#collapse-dev-3">
                IntelliJ IDEA
              </a>
            </h4>
          </div>
          <div id="collapse-dev-3" class="panel-collapse collapse">
            <div class="panel-body">
              <p><a href="https://www.jetbrains.com/idea/" target="_blank">IntelliJ IDEA</a> is a light-weight IDE for Java, developed by <a href="https://www.jetbrains.com/" target="_blank">JetBrains</a>. The following instructions will get you set up for developing with ADAMS.</p>
              <div class="panel-group" id="accordion-intellij">
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-intellij" href="#collapse-intellij-6">
                        Setting up ADAMS
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-intellij-6" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>You can import ADAMS using the start screen of IntelliJ by clicking on <em>Import project</em>:</p>
                      <p/>
                        <img src="img/tools/intellij-import_project-adams2.png"/>
                      </p>
                      <p>Or by selecting <em>File -&gt; Import project...</em> from the main menu.</p>
                      <p/>
                        <img src="img/tools/intellij-import_project-adams.png"/>
                      </p>
                      <p>Then, select the top-level directory of ADAMS and import it as Maven project:
                        <ul>
                          <li>import module from external model: Maven</li>
                          <li>check <em>import Maven projects automatically</em></li>
                          <li>check <em>create module groups for multi-module Maven projects</em></li>
                          <li>select any relevant Maven profiles (or just use all of them)</li>
                        </ul>
                      </p>
                      <p>If you want to add other projects, like <em>adams-addons</em> or <em>adams-incubator</em>, you must import them via the main menu's <em>File -&gt; Import module...</em> (<strong>not</strong> via Import project!).</p>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-intellij" href="#collapse-intellij-7">
                        Configuring the JDK
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-intellij-7" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>Once you've imported ADAMS, you can configure the JDK that you want to use (1.8 at the time of writing). For this, open <em>Project structure</em> from the main menu.</p>
                      <p>Under <em>SDKs</em> you can define all the SDKs that you want to be able to use (simply click on <strong>+</strong> and select the top-level directory of your JDK):</p>
                      <p/>
                        <img src="img/tools/intellij-sdks.png"/>
                      </p>
                      <p>And under <em>Project</em>, you can then select the SDK that you want to use for the project:<p/>
                      <p/>
                        <img src="img/tools/intellij-project-sdk.png"/>
                      </p>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-intellij" href="#collapse-intellij-2">
                        Code formatting
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-intellij-2" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>ADAMS uses mixed spaces/tabs for indentation, with indentation being 2 spaces and a tab representing 8 spaces.</p>
                      <p/>
                        <img src="img/tools/intellij-indentation.png"/>
                      </p>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-intellij" href="#collapse-intellij-3">
                        Automatically compile projects
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-intellij-3" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>Usually, you don't want to compile when you launch the application, but whenever you change the code. Hence, enable "auto make":</p>
                      <p/>
                        <img src="img/tools/intellij-make.png"/>
                      </p>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-intellij" href="#collapse-intellij-4">
                        Application defaults
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-intellij-4" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>Despite having <em>auto make</em> enabled, it pays off to have a build action before launching applications. Hence change the <em>Before launch</em> action to use <em>Make, no error check</em>. Furthermore, you will most likely have the module's top level directory as the default working directory when starting up the application. You can set this using the <code>$MODULE_DIR$</code> variable.</p>
                      <p/>
                        <img src="img/tools/intellij-app_defaults.png"/>
                      </p>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-intellij" href="#collapse-intellij-5">
                        Color themes
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-intellij-5" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>There are a plethora of color themes for IntelliJ out there, in case you don't like the ones it is shipped with:<p/>
                      <p><a href="http://www.ideacolorthemes.org/home/" target="_blank">http://www.ideacolorthemes.org/home/</a></p>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-intellij" href="#collapse-intellij-8">
                        Launching ADAMS
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-intellij-8" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>For creating a launcher (or <em>Run configuration</em>), you select <em>Run -&gt; Edit configurations...</em> from the main menu. When clicking on the <strong>+</strong>, use <em>Application</em> as template and fill in <code>adams.gui.Main</code> as the main class and the amount of RAM that you want to use, eg 2GB:</p>
                      <p/>
                        <img src="img/tools/intellij-main.png"/>
                      </p>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-intellij" href="#collapse-intellij-9">
                        Editor menu
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-intellij-9" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>Rather than always using the <em>Find action</em> functionality via <code>Ctrl+Shift+A</code>, it sometimes pays off to simply adjust the corresponding menu. For instance, bringing up the <em>type hierarchy</em> for a class or the <em>implementations</em> or <em>declaration</em> of a method, is something frequently used in a larger framework. Here is what the modified <em>Editor Popup Menu</em> looks like:</p>
                      <p/>
                        <img src="img/tools/intellij-editor_menu.png"/>
                      </p>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-intellij" href="#collapse-intellij-10">
                        External tools
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-intellij-10" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>Whether you want to launch your image editing tool (e.g., <a href="http://www.gimp.org/" target="_blank">Gimp</a> for creating icons) or launching Maven to auto-generate code (e.g., when using <a href="http://cxf.apache.org/" target="_blank">Apache CXF</a>), then you can use IDEA's <em>External tools</em> facility:</p>
                      <p/>
                        <img src="img/tools/intellij-external_tools.png"/>
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion-dev" href="#collapse-dev-4">
                Eclipse
              </a>
            </h4>
          </div>
          <div id="collapse-dev-4" class="panel-collapse collapse">
            <div class="panel-body">
              <p>You can directly import Maven projects in <a href="http://www.eclipse.org/" target="_blank">Eclipse</a> using the <a href="http://eclipse.org/m2e/" target="_blank">m2e</a> plugin. You can import <a href="resources/eclipse-code-formatting.xml" target="_blank">this code formatting setup</a>. See the <em>adams-core</em> manual, section <em>Tools</em>, subsection <em>Eclipse</em> for more details.</p>
              <p>In order to start the ADAMS user interface, you need to create a Run configuration with the following main class:</p>
              <p><code>adams.gui.Main</code></p>
              <p>All example flows use the placeholder <code>${EXAMPLE_FLOWS}</code>, which is relative to the module's path. In order to execute the example flows from module <em>adams-weka</em>, you need to set <em>adams-weka</em> as project in your launcher.</p>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion-dev" href="#collapse-dev-5">
                Continuous integration
              </a>
            </h4>
          </div>
          <div id="collapse-dev-5" class="panel-collapse collapse">
            <div class="panel-body">
              <p>ADAMS is being built (and tested) every night (New Zealand time) using the <a href="http://hudson-ci.org/" target="_blank">Hudson Continuous Integration</a> server, to pick up code commits that (potentially) break the framework.</p>
              <p>You can check out the current state of the ADAMS build at the following URL:</p>
              <p><code><a href="https://adams.cms.waikato.ac.nz/hudson/" target="_blank">https://adams.cms.waikato.ac.nz/hudson/</a></code></p>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion-dev" href="#collapse-dev-6">
                Extending
              </a>
            </h4>
          </div>
          <div id="collapse-dev-6" class="panel-collapse collapse">
            <div class="panel-body">
              <p>What do you need to do to create a new actor? Not much, simply create a new class and add a 16x16 icon for this actor. That's it!</p>
              <p>The following sections will guide you through the process of implementing your first actor.</p>
              <div class="panel-group" id="accordion-extending">
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-extending" href="#collapse-extending-1">
                        The class
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-extending-1" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>In the example here, we will be implementing a simple transformer that can take integers, doubles and numbers in string representation. This transformer then adds the number 42 to them and forwards the result for further processing.</p>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-extending" href="#collapse-extending-2">
                        Picking the superclass
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-extending-2" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>The four types of actors in ADAMS, standalone, source, transformer and sink, are determined by two interfaces, depending on whether input is accepted and/or output is generated:</p>
                      <ul>
                        <li><code>adams.flow.core.InputConsumer</code> (transformer, sink)</li>
                        <li><code>adams.flow.core.OutputProducer</code> (source, transformer)</li>
                      </ul>
                      <p>But you don't have to implement these interfaces yourself, there are already some abstract superclasses that you can directly derive from:</p>
                      <ul>
                        <li><code>adams.flow.standalone.AbstractStandalone</code></li>
                        <li><code>adams.flow.source.AbstractSource</code></li>
                        <li><code>adams.flow.transformer.AbstractTransformer</code></li>
                        <li><code>adams.flow.sink.AbstractSink</code></li>
                      </ul>
                      <p>Thanks to ADAMS' dynamic class discovery, you only have to place your classes in the same package as these abstract superclasses. If you want to use a different class hierarchy, you have to let ADAMS know about in form of a properties file. For instance, for developing our new transformer, called <code>org.awesome.transformer.Funky</code>, you have to create a file called <code>ClassLister.props</code> in the <code>adams.core</code> package with the following content:</p>
                      <pre>
adams.flow.core.AbstractActor=\
  org.awesome.transformer</pre>
                      <p>Ultimately, all actors are derived from <code>adams.flow.core.AbstractActor</code>, hence you need ADAMS let know in which packages to look for them.</p>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-extending" href="#collapse-extending-3">
                        Documentation
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-extending-3" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>In order to keep documentation relevant and avoid duplication, it is placed directly into the code. Each actor has a <code>globalInfo</code> method returning the main description in the help available in the GUI.</p>
                      <p>In our example, the the method would look like this:</p>
                      <pre>
public String globalInfo() {
  return "Our funky transformer. Adds 42 to incoming data.";
}</pre>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-extending" href="#collapse-extending-4">
                        Input and output
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-extending-4" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>Before a flow is executed, ADAMS checks whether the actors are actually compatible with each other. For this <strong>type check</strong>, InputConsumers have an <code>accepts()</code> method and OutputProducers a <code>generates()</code> one, each return an array of classes.</p>
                      <p>Our <em>Funky</em> transformer is supposed to take integers, doubles and strings. In other words, the <code>accepts(</code>) method looks like this:</p>
                      <pre>
public Class[] accepts() {
  return new Class[]{Integer.class, Double.class, String.class};
}</pre>
                      <p>As output, the transformer only generates doubles. Here is the corresponding <code>generates()</code> method:</p>
                      <pre>
public Class[] generates() {
  return new Class[]{Double.class};
}</pre>
                      <p>Any actor that outputs numbers (e.g., <code>adams.flow.source.RandomNumberGenerator</code>) or strings (e.g., <code>adams.flow.source.StringConstants</code>), will be compatible with our transformer.</p>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-extending" href="#collapse-extending-5">
                        Processing data
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-extending-5" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>Since the handling of documentation and compatibility is covered, we can concentrate on the actual processing of the data.</p>
                      <p>The life cycle of an actor is as follows:</p>
                      <ol>
                        <li><code>setUp()</code> (initialization)</li>
                        <li><code>execute()</code> (called with each token passing through, in case of transformers)</li>
                        <li><code>wrapUp()</code> (called after flow finishes)</li>
                        <li><code>destroy()</code> (for freeing up memory, etc.)</li>
                      </ol>
                      <p>The <code>execute()</code> is just a wrapper around the following three methods:</p>
                      <ol>
                        <li><code>preExcecute()</code></li>
                        <li><code>doExcecute()</code></li>
                        <li><code>postExcecute()</code></li>
                      </ol>
                      <p>In our case, only the <code>doExecute()</code> method needs to be implemented, as it is the only that is abstract. The others perform other duties, like debugging output of the size of the actor before/after the <code>doExecute()</code> call for tracking memory leaks.</p>
                      <p>Data gets passed around in the flow as tokens and the container class dealing with it is <code>adams.flow.core.Token</code> (the actual data is its payload). The <code>AbstractTransformer</code> class already contains a member variable for the input, <code>m_InputToken</code>, and one for the output, <code>m_OutputToken</code>. Leaving the output token at null stops the execution of any actor following ours. We will be using this approach in case we encounter a string that we can't parse as a double. The <code>doExecute()</code> method also returns string, which is used to return error messages (<code>null</code> if everything is fine). If we have a valid number, we add 42 to it.</p>
                      <p>Here is the code processing the data:</p>
                      <pre>
protected String doExecute() {
  String result = null;
  Number number = null;
  if (m_InputToken.getPayload() instanceof String) {
    try {
      number = new Double((String) m_InputToken.getPayload());
    } catch (Exception e) {
      number = null;
      result = "Failed to parse input string '" + m_InputToken.getPayload() + "' as number: " + e;
    }
  }
  else {
    number = (Number) m_InputToken.getPayload();
  }
  if (number != null)
    m_OutputToken = new Token(number.doubleValue() + 42.0);
  return result;
}</pre>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-extending" href="#collapse-extending-6">
                        The full implementation
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-extending-6" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>And here is the full implementation of our transformer:</p>
                      <pre>
package adams.flow.transformer;

import adams.flow.core.Token;

public class Funky extends AbstractTransformer {
  public String globalInfo() {
    return "Our funky transformer. Adds 42 to incoming data.";
  }
  public Class[] accepts() {
    return new Class[]{Integer.class, Double.class, String.class};
  }
  public Class[] generates() {
    return new Class[]{Double.class};
  }
  protected String doExecute() {
    String result = null;
    Number number = null;
    if (m_InputToken.getPayload() instanceof String) {
      try {
	number = new Double((String) m_InputToken.getPayload());
      } catch (Exception e) {
	number = null;
	result = "Failed to parse input string '" + m_InputToken.getPayload() + "' as number: " + e;
      }
    }
    else {
      number = (Number) m_InputToken.getPayload();
    }
    if (number != null)
      m_OutputToken = new Token(number.doubleValue() + 42.0);
    return result;
  }
}</pre>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-extending" href="#collapse-extending-7">
                        Option handling
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-extending-7" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>Though not necessary for this example, I will still cover briefly how option handling works in ADAMS.</p>
                      <p>Each option that is to be available through the user interface, needs to implement a <strong>get</strong>, a <strong>set</strong> and a <strong>tool-tip</strong> method. The latter contains the documentation for the option.</p>
                      <p>In our transformer example, we might want to make the actor a bit more flexible and allow the user to choose and increment different from 42. We could call the option (or property in Java Beans terms) <em>increment</em>. This will result in the following three methods:</p>
                      <ul>
                        <li><code>getIncrement()</code></li>
                        <li><code>setIncrement(double)</code></li>
                        <li><code>incrementTipText()</code></li>
                      </ul>
                      <p>Now we have to register this property with the actor as an option, in order to make it accessible in the user interface. This happens in the methdo <code>defineOptions()</code>, by adding an option description to the option manager. This description includes the command-line string of the option, the Bean property name and the default value. For numeric values you can also describe lower and upper bounds. We don't need really need bounds, but for demonstration purposes, we only want to allow positive values or zero:</p>
                      <pre>
public void defineOptions() {
  super.defineOptions();
  m_OptionManager.add(
          "inc", "increment",
          42.0, 0.0, null);
}</pre>
                      <p>One more important thing to mention: each <code>set</code> method for an option needs to call the <code>reset()</code> method. This call signals the actor that the options have changed and the current state is no longer valid.</p>
                      <p>The complete actor code now looks like this:</p>
                      <pre>
package adams.flow.transformer;

import adams.flow.core.Token;

public class Funky extends AbstractTransformer {
  protected double m_Increment;
  public String globalInfo() {
    return "Our funky transformer.";
  }
  public void defineOptions() {
    super.defineOptions();
    m_OptionManager.add(
	    "inc", "increment",
	    42.0, 0.0, null);
  }
  public void setIncrement(double value) {
    if (value >= 0) {
      m_Increment = value;
      reset();
    } else {
      getSystemErr().println("Increment must be >= 0, provided: " + value);
    }
  }
  public double getIncrement() {
    return m_Increment;
  }
  public String incrementTipText() {
    return "The amount to add to the incoming values.";
  }
  public Class[] accepts() {
    return new Class[]{Integer.class, Double.class, String.class};
  }
  public Class[] generates() {
    return new Class[]{Double.class};
  }
  protected String doExecute() {
    String result = null;
    Number number = null;
    if (m_InputToken.getPayload() instanceof String) {
      try {
	number = new Double((String) m_InputToken.getPayload());
      } catch (Exception e) {
	number = null;
	result = "Failed to parse input string '" + m_InputToken.getPayload() + "' as number: " + e;
      }
    }
    else {
      number = (Number) m_InputToken.getPayload();
    }
    if (number != null)
      m_OutputToken = new Token(number.doubleValue() + m_Increment);
    return result;
  }
}</pre>
                      <p>One final note: instead of using <code>System.out</code> and <code>System.err</code>, actors should use <code>getSystemOut()</code> and <code>getSystemErr()</code> for output on the console. By doing this, output from stdout and stderr gets captured by ADAMS' logging facility. Debugging output can be output using for instance <code>debug(String)</code>.</p>
                    </div>
                  </div>
                </div>
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#accordion-extending" href="#collapse-extending-8">
                        The icon
                      </a>
                    </h4>
                  </div>
                  <div id="collapse-extending-8" class="panel-collapse collapse">
                    <div class="panel-body">
                      <p>As for the icon that goes with the actor, it is simple a GIF, PNG or JPG image with the same filename as the actor, placed in the <code>adams.gui.images</code> package. For instance, using our <code>org.awesome.transformer.Funky</code> transformer example, you could create a file called <code>org.awesome.transformer.Funky.gif</code>, using one of these templates:</p>
                      <ul>
                        <li><code>adams.flow.standalone.Unknown.gif</code></li>
                        <li><code>adams.flow.source.Unknown.gif</code></li>
                        <li><code>adams.flow.transformer.Unknown.gif</code></li>
                        <li><code>adams.flow.sink.Unknown.gif</code></li>
                      </ul>
                      <p>The templates already contain a frame with the color associated with the type of actor: <font color="red">standalone</font>, <font color="orange">source</font>, <font color="green">transformer</font> and <font color="grey">sink</font>.</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="footer-simple">
      </div>
      <script>$("#footer-simple").load("footer.html");</script>
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/bootstrap.min.js"></script>
  

</body></html>
